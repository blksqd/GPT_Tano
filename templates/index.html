<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Dog Nutrition Chatbot</title>
	<link rel="stylesheet" type="text/css" href="/static/styles.css">
</head>
<body>
	<h1>Virtual Dog Nutrition Coach</h1>
  <h2>Hi, my name is Lars, and I am here to help you answer some 
      questions about your dog's nutrition. Wether you want to train 
      him for something in particular or your dog is not having a great time. 
      Diet can be one of the most important aspects to control.</h2>
<div id="chatbox">
    <div id="messages">
        <div class="chat-message">
            <div class="chat-message-content" id="initial-message">
            </div>
        </div>
    </div>
    <div class="loading-dots" style="display: none;">
        <span>.</span>
        <span>.</span>
        <span>.</span>
    </div>
</div>
    <form id="input-form">
        <input type="text" id="user_input" placeholder="Type your question here...">
        <button type="submit">Send</button>
    </form>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
  $(document).ready(function () {
    $('#input-form').on('submit', function (e) {
      e.preventDefault();
      let user_input = $('#user_input').val();
      $('#messages').append('<p class="user-message">' + user_input + '</p>');
      $('#user_input').val('');

      // Show the loading dots when waiting for the chatbot's response
      toggleLoadingDots();

      $.ajax({
        type: 'POST',
        url: '/ask',
        data: {user_input: user_input},
        success: function (data) {
          // Hide the loading dots before showing the chatbot's response
          toggleLoadingDots();

          let response = data.response;
          $('#messages').append('<p class="bot-message">' + response + '</p>');
          $('#chatbox').scrollTop($('#chatbox')[0].scrollHeight);
        }
      });
    });
  });

  function toggleLoadingDots() {
    const loadingDots = document.querySelector('.loading-dots');
    if (loadingDots.style.display === 'none') {
      loadingDots.style.display = 'inline-block';
    } else {
      loadingDots.style.display = 'none';
    }
  }

  // Get the initial message element
const initialMessage = document.getElementById('initial-message');

// Remove the initial message element after the first message is sent
document.querySelector('form').addEventListener('submit', function() {
  initialMessage.remove();
});

</script>
</body>
</html>
